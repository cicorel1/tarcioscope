<!DOCTYPE html>
<html lang="{{request.locale_name}}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>tarcioscope</title>

    <!-- Custom styles for this scaffold -->
    <link href="{{request.static_url('tarcioscope:static/app.css')}}" rel="stylesheet">
  </head>

  <body>
  {% block content %}
    <p>No content</p>
  {% endblock content %}
  </body>

  <script type="text/javascript" src="{{request.static_url('tarcioscope:static/jsmpeg.min.js')}}"></script>

  <script type="text/javascript">
    // Show loading notice
    const canvas = document.getElementById('videoCanvas');
    const ctx = canvas.getContext('2d');
    ctx.fillStyle = '#444';
    ctx.fillText('Loading...', canvas.width/2-30, canvas.height/3);
    // Setup the WebSocket connection and start the player
    const url = `ws://${window.location.hostname}/video`;
    const player = new JSMpeg.Player(url, { canvas: canvas, audio: false });
  </script>

  <script type="text/javascript">
    const cb = () => {
      canvas.width = window.innerWidth;
    }

    if (document.readyState === 'complete' ||
        (document.readyState !== 'loading' && !document.documentElement.doScroll)) {
      cb()
    } else {
      document.addEventListener('DOMContentLoaded', cb)
    }

    window.addEventListener('resize', cb);
  </script>
</html>
